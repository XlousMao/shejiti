# 第四章 · 第一题

**4.1 设有n个顾客同时等待一项服务，顾客i需要的服务时间为ti，i=1，2，…，n。从时刻0开始计时。若在时刻t开始对顾客i服务，那么i的等待时间就是t。应该怎样安排n个顾客的服务次序使得总的等待时间(每个顾客等待时间的总和)最少?**

1.  **使用贪心法求解这个问题时的贪心选择策略是什么?**
2.  **简单写出贪心法的算法描述。**

**(3) 假设服务时间分别为{1，3，2，15，10，6，12}，用贪心法给出这个问题的解。**

贪心策略是服务时间较短的优先安排。

假设调度f的顺序是i1，i2，…，ij，…，in，那么ik的等待时间是![](data:image/x-wmf;base64,183GmgAAAAAAANsD0gTsCQAAAAD0WQEACQAAA5kBAAACABwAAAAAAAUAAAAJAgAAAAAFAAAAAgEBAAAABQAAAAEC////AAUAAAAuARgAAAAFAAAACwIAAAAABQAAAAwCYASAAxIAAAAmBg8AGgD/////AAAQAAAAwP///7H///9AAwAAEQQAAAsAAAAmBg8ADABNYXRoVHlwZQAA8AAcAAAA+wLA/QAAAAAAAJABAAAAAgQCABBTeW1ib2wArAAACgAYcjcI/v///5jcGQBcJMJ2QAAAAAQAAAAtAQAACAAAADIK2QI3AAEAAADlABwAAAD7AiD/AAAAAAAAkAEAAAACBAIAEFN5bWJvbAB4AAAKANh0Nwj+////mNwZAFwkwnZAAAAABAAAAC0BAQAEAAAA8AEAAAgAAAAyCvoA3wABAAAALXkIAAAAMgrvA90AAQAAAD15HAAAAPsCIP8AAAAAAACQAQAAAAAEAgAQVGltZXMgTmV3IFJvbWFuAP7///+Y3BkAXCTCdkAAAAAEAAAALQEAAAQAAADwAQEACAAAADIK+gBOAQEAAAAxAAgAAAAyCu8DTAEBAAAAMQAcAAAA+wIg/wAAAAAAAJABAQAAAAQCABBUaW1lcyBOZXcgUm9tYW4A/v///5jcGQBcJMJ2QAAAAAQAAAAtAQEABAAAAPABAAAIAAAAMgr6AF4AAQAAAGsACAAAADIK7wOJAAEAAABqAAgAAAAyCuACagIBAAAAaQAcAAAA+wJg/wAAAAAAAJABAQAAAAQCABBUaW1lcyBOZXcgUm9tYW4A/v///5jcGQBcJMJ2QAAAAAQAAAAtAQAABAAAAPABAQAIAAAAMgoYA8cCAQAAAGp5HAAAAPsCgP4AAAAAAACQAQEAAAAEAgAQVGltZXMgTmV3IFJvbWFuAP7///+Y3BkAXCTCdkAAAAAEAAAALQEBAAQAAADwAQAACAAAADIKgAL5AQEAAAB0AAoAAAAmBg8ACgD/////AQAAAAAAHAAAAPsCEAAHAAAAAAC8AgAAAIYBAgIiU3lzdGVtAD20AIoFAAAKAFgYZj1YGGY9tACKBfjdGQAEAAAALQEAAAQAAADwAQEAAwAAAAAA)。总的等待时间![](data:image/x-wmf;base64,183GmgAAAAAAAAUP0gTsCQAAAAAqVQEACQAAAyICAAACABwAAAAAAAUAAAAJAgAAAAAFAAAAAgEBAAAABQAAAAEC////AAUAAAAuARgAAAAFAAAACwIAAAAABQAAAAwCYASgDRIAAAAmBg8AGgD/////AAAQAAAAwP///7H///9gDQAAEQQAAAsAAAAmBg8ADABNYXRoVHlwZQAA8AAcAAAA+wLA/QAAAAAAAJABAAAAAgQCABBTeW1ib2wAogAACgDYyiMI/v///5jcGQBcJMJ2QAAAAAQAAAAtAQAACAAAADIK2QJhBgEAAADl/BwAAAD7AiD/AAAAAAAAkAEAAAACBAIAEFN5bWJvbACBAAAKABjNIwj+////mNwZAFwkwnZAAAAABAAAAC0BAQAEAAAA8AEAAAgAAAAyCu8DBwcBAAAAPZMcAAAA+wKA/gAAAAAAAJABAAAAAgQCABBTeW1ib2wAowAACgD4yiMI/v///5jcGQBcJMJ2QAAAAAQAAAAtAQAABAAAAPABAQAIAAAAMgqAArUJAQAAAC0ACAAAADIKgAI4BQEAAAA9GhwAAAD7AiD/AAAAAAAAkAEBAAAABAIAEFRpbWVzIE5ldyBSb21hbgD+////mNwZAFwkwnZAAAAABAAAAC0BAQAEAAAA8AEAAAgAAAAyCvoA9QYBAAAAbgAIAAAAMgrvA7MGAQAAAGppCAAAADIK4AJ+DAEAAABpABwAAAD7AmD/AAAAAAAAkAEBAAAABAIAEFRpbWVzIE5ldyBSb21hbgD+////mNwZAFwkwnZAAAAABAAAAC0BAAAEAAAA8AEBAAgAAAAyChgD2wwBAAAAankcAAAA+wKA/gAAAAAAAJABAQAAAAQCABBUaW1lcyBOZXcgUm9tYW4A/v///5jcGQBcJMJ2QAAAAAQAAAAtAQEABAAAAPABAAAIAAAAMgqAAg0MAQAAAHSRCAAAADIKgAIRCwEAAABqAAgAAAAyCoACswgBAAAAbgAIAAAAMgqAApoDAQAAAGaRCQAAADIKgAIuAAQAAAB0aW1lHAAAAPsCIP8AAAAAAACQAQAAAAAEAgAQVGltZXMgTmV3IFJvbWFuAP7///+Y3BkAXCTCdkAAAAAEAAAALQEAAAQAAADwAQEACAAAADIK7wN2BwEAAAAxaRwAAAD7AoD+AAAAAAAAkAEAAAAABAIAEFRpbWVzIE5ldyBSb21hbgD+////mNwZAFwkwnZAAAAABAAAAC0BAQAEAAAA8AEAAAgAAAAyCoACjwsBAAAAKWkIAAAAMgqAAikIAQAAACiTCAAAADIKgAJgBAEAAAAp/AgAAAAyCoACyAIBAAAAKJMKAAAAJgYPAAoA/////wEAAAAAABwAAAD7AhAABwAAAAAAvAIAAACGAQICIlN5c3RlbQAstACKBQAACgDTG2Ys0xtmLLQAigX43RkABAAAAC0BAAAEAAAA8AEBAAMAAAAAAA==)

排序使得t1≤t2≤…≤tn，按照1，2，…，i，…，n的顺序安排服务。f\*的总等待时间为![](data:image/x-wmf;base64,183GmgAAAAAAAOIOrwTsCQAAAACwVAEACQAAA/YBAAACABwAAAAAAAUAAAAJAgAAAAAFAAAAAgEBAAAABQAAAAEC////AAUAAAAuARgAAAAFAAAACwIAAAAABQAAAAwCQASADRIAAAAmBg8AGgD/////AAAQAAAAwP///7H///9ADQAA8QMAAAsAAAAmBg8ADABNYXRoVHlwZQAA4AAcAAAA+wLA/QAAAAAAAJABAAAAAgQCABBTeW1ib2wA2QAACgDooB8F/v///5jcGQBcJMJ2QAAAAAQAAAAtAQAACAAAADIK2QIJBwEAAADlABwAAAD7AiD/AAAAAAAAkAEAAAACBAIAEFN5bWJvbADHAAAKAOimHwX+////mNwZAFwkwnZAAAAABAAAAC0BAQAEAAAA8AEAAAgAAAAyCu8DlQcBAAAAPQAcAAAA+wKA/gAAAAAAAJABAAAAAgQCABBTeW1ib2wA2gAACgDooB8F/v///5jcGQBcJMJ2QAAAAAQAAAAtAQAABAAAAPABAQAIAAAAMgqAAl0KAQAAAC0ACAAAADIKgALgBQEAAAA9ABwAAAD7AiD/AAAAAAAAkAEBAAAABAIAEFRpbWVzIE5ldyBSb21hbgD+////mNwZAFwkwnZAAAAABAAAAC0BAQAEAAAA8AEAAAgAAAAyCvoAnQcBAAAAbgAIAAAAMgrvA0UHAQAAAGkACAAAADIK4ALMDAEAAABpoBwAAAD7AoD+AAAAAAAAkAEBAAAABAIAEFRpbWVzIE5ldyBSb21hbgD+////mNwZAFwkwnZAAAAABAAAAC0BAAAEAAAA8AEBAAgAAAAyCoACWwwBAAAAdAAIAAAAMgqAAmULAQAAAGmgCAAAADIKgAJbCQEAAABuAAgAAAAyCoACmgMBAAAAZnQJAAAAMgqAAi4ABAAAAHRpbWUcAAAA+wIg/wAAAAAAAJABAAAAAAQCABBUaW1lcyBOZXcgUm9tYW4A/v///5jcGQBcJMJ2QAAAAAQAAAAtAQEABAAAAPABAAAIAAAAMgrvAwQIAQAAADGgHAAAAPsCgP4AAAAAAACQAQAAAAAEAgAQVGltZXMgTmV3IFJvbWFuAP7///+Y3BkAXCTCdkAAAAAEAAAALQEAAAQAAADwAQEACAAAADIKgALdCwEAAAApoAgAAAAyCoAC0QgBAAAAKAAIAAAAMgqAAk4EAgAAACopCAAAADIKgALIAgEAAAAoAAoAAAAmBg8ACgD/////AQAAAAAAHAAAAPsCEAAHAAAAAAC8AgAAAIYBAgIiU3lzdGVtAAu0AIoFAAAKAGQaZgtkGmYLtACKBfjdGQAEAAAALQEBAAQAAADwAQAAAwAAAAAA)

命题4.1 对任何输入，对服务时间短的顾客优先安排将得到最优解。

证

使用交换论证的方法。假设存在某个最优解g存在i,j∈A,i<j,但是i在j之后得到服务。那么在g的安排中一定存在相邻安排的顾客i和j,使得i<j但i在j之后得到服务。交换i和j得到新的服务顺序g'。那么

time(g)-time(g')=tj\-ti≥0

总等待时间将不会增加,因此g'也是最优解。至多经过n(n-1)/2次这样的交换,就可以将g转化成算法的解f\*。从而证明了f\*是最优解。

1.  算法Service(T)

输入:T\[1..n\]是服务时间t1,t2,…,tn的数组

输出:函数f,f(i)为第i个顾客的开始服务时刻，i=1,2,…,n

1.sort(T) //按照服务时间从小到大的顺序排列

2\. f(1)←0

3.for i←2 to n

4\. f(i)←f(i-1)+ti-1

5\. return f

算法的最坏情况下的时间复杂度为O(nlogn)。

服务顺序为：1，3，2，6，5，7，4。其开始服务时刻为：f(1)=0，f(3)=1，f(2)=3，f(6)=6，f(5)=12，f(7)=22，f(4)=34。总等待时间

time(f)=1×6+2×5+3×4+6×3+10×2+12×1=78

#include <iostream>

#include <algorithm>

using namespace std;

typedef struct{

int id,t;

}C;

int n,t\[100\],f\[100\],i,Time;

C N\[100\];

bool cmp(C x,C y)

{

return x.t<y.t;

}

void Service()

{

f\[1\]=0;

for(i=2;i<=n;i++)

f\[i\]=f\[i-1\]+t\[i-1\];

}//Service

int main()

{

while(cin>>n)

{

for(i=1;i<=n;i++)

{

N\[i\].id=i;

cin>>N\[i\].t;

}//for

sort(N+1,N+n+1,cmp);//按恪?照?服务?时骸?间?从洙?小?到?大洙?对?顾?客í排?序ò

for(i=1;i<=n;i++)

t\[i\]=N\[i\].t;

Service();

Time=f\[1\];

for(i=2;i<=n;i++)

Time+=f\[i\];

cout<<Time<<endl;

for(i=1;i<n;i++)

cout<<N\[i\].id<<",";

cout<<N\[n\].id<<endl;

}//while

return 0;

}

/\*

7

1 3 2 15 10 6 12

/////////

78

1,3,2,6,5,7,4

\*/

/\*

4

5 20 3 15

/////////

34

3,1,4,2

\*/
